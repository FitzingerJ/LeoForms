<div style="width: 100%; height: 100vh; display: flex;">
  <!-- Symbol Palette -->
  <div style="width: 250px; border-right: 1px solid #ccc;">
    <ejs-symbolpalette
      #symbolPalette
      id="symbolpalette"
      [palettes]="palettes"
      [symbolHeight]="60"
      [symbolWidth]="60"
      [symbolMargin]="symbolMargin"
      [getSymbolInfo]="getSymbolInfo"
      [getNodeDefaults]="getSymbolDefaults"
      width="100%"
      height="100%">
    </ejs-symbolpalette>
  </div>

  <!-- Diagram Area -->
  <div style="flex: 1; display: flex; flex-direction: column;">

    <div style="display: flex; gap: 10px; padding: 10px;">
      <button
        (click)="activateConnectorClickMode()"
        [ngStyle]="{
          backgroundColor: isConnectionMode ? '#28a745' : '#007bff',
          color: 'white',
          border: 'none',
          padding: '10px 15px',
          cursor: 'pointer'
        }"
      >
        {{ isConnectionMode ? 'Verbindungsmodus aktiv – Klicken zum Verbinden' : 'Verbindung erstellen' }}
      </button>

      <button (click)="saveDiagram()" style="padding: 10px;">Speichern</button>
      <button (click)="loadDiagram()" style="padding: 10px;">Laden</button>
      <button (click)="validateDiagram()" style="padding: 10px;">Validieren</button>
    </div>

    <ejs-diagram
      #diagram
      id="diagram"
      width="100%"
      height="100%"
      [nodes]="nodes"
      [connectors]="connectors"
      [tool]="tool"
      (click)="onDiagramClick($event)">
    </ejs-diagram>

    <!-- Zuweisungseingabe bei Bausteinklick -->
    <div *ngIf="selectedNodeForAssignment" style="margin: 10px;">
      <mat-form-field appearance="fill" style="width: 300px;">
        <mat-label>Person oder Gruppe für '{{ selectedNodeForAssignment?.annotations?.[0]?.content }}'</mat-label>
        <input matInput [formControl]="assignmentControl" [matAutocomplete]="auto">
        <mat-autocomplete #auto="matAutocomplete" (optionSelected)="onAssignmentSelected($event)">
          <mat-option *ngFor="let option of filteredAssignments | async" [value]="option">
            {{ option }}
          </mat-option>
        </mat-autocomplete>
      </mat-form-field>
    </div>
  </div>
</div>